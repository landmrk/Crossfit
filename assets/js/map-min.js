mapboxgl.accessToken="pk.eyJ1IjoibGFuZG1yayIsImEiOiJjajV1dzZqemkxczA2MndxdHZrN3I0dGhtIn0.OQf_LxW3LV68pDjF4pTxdQ";var map=new mapboxgl.Map({container:"map",style:"mapbox://styles/landmrk/ckcd73d8e7sca1imtabjdx8hr",zoom:8,center:[-2.230155,53.789061],pitch:1});function setmapFacts(a){map.addSource("places",{type:"geojson",data:a,cluster:!1}),map.loadImage("../assets/imgs/hotspot.png",((a,e)=>{if(a)throw a;map.addImage("hotspot",e)})),map.addLayer({id:"places",type:"symbol",source:"places",layout:{"icon-image":"hotspot","icon-allow-overlap":!0,"icon-size":.5,"icon-offset":[0,-77]}}),map.on("click","places",(function(a){var e=a.features[0].geometry.coordinates.slice();const{figure:t,icon:o,poi:n,location:p}=a.features[0].properties,s=`<h4 style="margin-bottom:5px">Famous Person</h4> <p>${o}</p><h4 style="margin-bottom:5px">Location</h4> <p>${p}</p> <h4 style="margin-bottom:5px">Point of Interest</h4> <p><a href="${t}" target="_blank">${n}</a></p>`;for(;Math.abs(a.lngLat.lng-e[0])>180;)e[0]+=a.lngLat.lng>e[0]?360:-360;(new mapboxgl.Popup).setLngLat(e).setHTML(s).addTo(map)})),map.on("mouseenter","places",(function(){map.getCanvas().style.cursor="pointer"})),map.on("mouseleave","places",(function(){map.getCanvas().style.cursor=""}))}map.on("load",(function(){d3.json("https://8d2afuams5.execute-api.us-east-1.amazonaws.com/dev/getMap",(function(a,e){const{route:t,reachedRoute:o,mapFacts:n,metadata:p}=e;if(a)throw a;const{coordinates:s}=o.features[0].geometry,i=[s[0]];let r=o;r.features[0].geometry.coordinates=i,map.addSource("routeStatic",{type:"geojson",data:t}),map.addLayer({id:"routeStatic",type:"line",source:"routeStatic",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fff","line-opacity":.8,"line-width":6}}),map.addSource("trace",{type:"geojson",data:r}),map.addLayer({id:"trace",type:"line",source:"trace",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#50C9A4","line-opacity":1,"line-width":6}}),map.jumpTo({center:i[1],zoom:8}),map.setPitch(1);var c=0,m=window.setInterval((function(){c<s.length?(r.features[0].geometry.coordinates.push(s[c]),map.getSource("trace").setData(r),map.panTo(s[c]),c++):window.clearInterval(m)}),2500);map.loadImage("../assets/imgs/hotspot.png",((a,e)=>{if(a)throw a;map.addImage("info",e)})),setmapFacts(n),map.addControl(new mapboxgl.NavigationControl)}))}));